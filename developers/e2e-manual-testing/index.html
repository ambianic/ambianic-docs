<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>End to End System Testing in Dev Mode - Ambianic Documentation</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link href="../../css/flowchart.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <!-- flowchart js -->
        <script src="../../js/raphael.min.js"></script>
        <script src="../../js/flowchart.js"></script>
        <script src="../../js/jquery-plugin.js"></script>
        <!-- end flowchart js -->
        <!-- mermaid js -->
        <script src="https://unpkg.com/mermaid@8.4.0/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true});</script>
        <!-- end mermaid js -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <a class="navbar-brand" href="../..">Ambianic Documentation</a>
                </div>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../users/quickstart/" class="dropdown-item">Quick Start</a>
</li>
                                    
<li>
    <a href="../../users/ambianicbox/" class="dropdown-item">Ambianic Box</a>
</li>
                                    
<li>
    <a href="../../users/configure/" class="dropdown-item">Configuration</a>
</li>
                                    
<li>
    <a href="../../users/edge-pairing/" class="dropdown-item">Local and Remote pairing</a>
</li>
                                    
<li>
    <a href="../../users/hass-integration/" class="dropdown-item">Home Assistant Integration</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Developer Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../architecture/" class="dropdown-item">High Level System Architecture</a>
</li>
                                    
<li>
    <a href="../development-environment/" class="dropdown-item">Development Environment Setup</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">End to End System Testing in Dev Mode</a>
</li>
                                    
<li>
    <a href="../../legal/CONTRIBUTING/" class="dropdown-item">Contribution Guidelines</a>
</li>
                                    
<li>
    <a href="https://github.com/ambianic/ambianic-ui" class="dropdown-item">Ambianic UI git repo</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Ambianic Edge</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="https://github.com/ambianic/ambianic-edge" class="dropdown-item">Core Git Repo</a>
</li>
            
<li>
    <a href="https://ambianic.github.io/ambianic-edge/pythonapi/ambianic/" class="dropdown-item">Python API</a>
</li>
            
<li>
    <a href="https://ambianic.github.io/ambianic-edge/openapi/ambianic-edge-openapi.html" class="dropdown-item">OpenAPI(REST)</a>
</li>
            
<li>
    <a href="https://github.com/ambianic/fall-detection" class="dropdown-item">Fall Detection Model</a>
</li>
            
<li>
    <a href="https://github.com/ambianic/ambianic-quickstart" class="dropdown-item">Command Line Interface</a>
</li>
            
<li>
    <a href="https://github.com/ambianic/ambianic-rpi-image" class="dropdown-item">Operating System</a>
</li>
            
<li>
    <a href="https://github.com/ambianic/ambianic-box" class="dropdown-item">Physical Enclosure</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Peer to Peer Communication</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="https://webrtchacks.com/private-home-surveillance-with-the-webrtc-datachannel/" class="dropdown-item">p2p architecture</a>
</li>
            
<li>
    <a href="https://github.com/ambianic/peerjs-python" class="dropdown-item">peerjs-python git repo</a>
</li>
            
<li>
    <a href="https://github.com/ambianic/ambianic-pnp" class="dropdown-item">ambianic-pnp git repo</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../development-environment/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../legal/CONTRIBUTING/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/ambianic/ambianic-docs/edit/master/docs-md/developers/e2e-manual-testing.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column bs-sidenav">
            <li class="nav-item main"><a href="#end-to-end-system-testing-in-dev-mode">End to End System Testing in Dev Mode</a></li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="end-to-end-system-testing-in-dev-mode">End to End System Testing in Dev Mode</h1>
<p>In addition to writing automated unit tests for each project module and integrated tests across modules, 
we occasionally need to manually walk through the system to experience it the same way as an end user would.
Manual testing sometimes leads to discovering new issues that can be then covered with new automated tests.</p>
<p>Following is the recommended way to manually test an Ambianic system end to end in development mode, but as close as possible to realistic deployment conditions.</p>
<p>First, start the Ambianic UI and Ambianic Edge gitpod environments. If you haven't done this before, then follow <a href="../development-environment/">these instructions</a>.</p>
<p>Next, go to the Ambianic Edge dev environment and make sure that all main modules are running:
1. Core Monitoring and Inference Engine
1. REST API server (fastapi)
1. WebRTC - HTTP proxy</p>
<p>In your main workspace directory you should see a file named <code>.peerjsrc</code> with a contents similar to this:</p>
<pre><code>{&quot;peerId&quot;: &quot;77d4b8b4-bc2a-451a-9bed-28f07c3e1abc&quot;}
</code></pre>
<p>Copy to the system clipboard the peerId value from this json formatted file. Just the <code>77d4b8b4-bc2a-451a-9bed-28f07c3e1abc</code> part. 
Notice that this value is a randomly generated <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier#Version_4_(random)">UUID4</a> which will be unique for your environment.</p>
<p><img alt="Screen Shot 2021-09-07 at 7 33 11 PM" src="https://user-images.githubusercontent.com/2234901/132426954-9a52ee0c-14ed-47bb-be57-227e3f6e16fd.png" /></p>
<p>Next, go to the Ambianic UI environment, and make sure that the Ambianic PWA is being served by nodejs. Your terminal window should look like the screenshot below.</p>
<p><img alt="Screen Shot 2021-09-07 at 8 21 17 PM" src="https://user-images.githubusercontent.com/2234901/132430594-5413f915-131f-4c69-ac67-64f9f1e2a44b.png" /></p>
<p>Open a browser window pointing to port 8080 of the gitpod environment serving the Ambianic PWA on nodejs in dev mode.</p>
<p><img alt="Screen Shot 2021-09-07 at 4 48 19 PM" src="https://user-images.githubusercontent.com/2234901/132427845-0c74edae-22c1-405c-a9e9-2c56375773e7.png" /></p>
<p>Click on <em>Begin Setup</em> then on the next page click <em>Skip</em> in the upper right corner of the app.</p>
<p><img alt="Screen Shot 2021-09-07 at 7 38 33 PM" src="https://user-images.githubusercontent.com/2234901/132428090-464f5c71-52b9-4498-8779-d7f1911f631d.png" /></p>
<p>On the next page, select the Main menu drop down in the Nav Bar and click Settings.</p>
<p><img alt="Screen Shot 2021-09-07 at 7 41 22 PM" src="https://user-images.githubusercontent.com/2234901/132428307-817493bb-8f0a-47a5-b3e7-31521ad732be.png" /></p>
<p>Then scroll down to the section titled "Pair with remote Ambianic Edge device".</p>
<p><img alt="Screen Shot 2021-09-07 at 7 40 43 PM" src="https://user-images.githubusercontent.com/2234901/132428376-126ed1e2-a385-4548-88e4-21253ccf584e.png" /></p>
<p>Paste the peerjs key value that you copied from the Ambianic Edge CDE. Click on Pair Remotely. 
In a few moments you will see snackbar status messages indicating that the UI is connecting to Ambianic Edge followed by a confirmation that connection is established.</p>
<p><img alt="Screen Shot 2021-09-07 at 7 41 08 PM" src="https://user-images.githubusercontent.com/2234901/132428700-e837f67d-5eaf-427d-80e2-518220de23b5.png" /></p>
<p>If you now scroll up to the top of the Settings page you will see the Peer ID and Version of the Ambianic Edge device you are connected to. 
This is in fact a connection to the gitpod CDE running Ambianic Edge in dev mode.</p>
<p><img alt="Screen Shot 2021-09-07 at 7 59 18 PM" src="https://user-images.githubusercontent.com/2234901/132429510-38d74d36-3961-4e5a-a797-a9f1584d6b14.png" /></p>
<p>Notice that we did not have to open any public HTTP/S ports on the Ambianic Edge CDE in order for the UI to access the virtual device. 
This is exactly how the UI and Edge connect in a real world deployment. 
Instead of relying on access to public HTTP/S endpoints, the UI and Edge connect securely and directly via WebRTC DataChannel 
(using <a href="https://github.com/ambianic/peerfetch">peerfetch</a> - an HTTP over WebRTC proxy).</p>
<p><img alt="Screen Shot 2021-09-07 at 8 26 53 PM" src="https://user-images.githubusercontent.com/2234901/132431003-489131f6-9642-4819-9659-1e65985530db.png" /></p>
<p>If you now navigate to the Timeline page, you will see a timeline view. </p>
<p><img alt="Screen Shot 2021-09-07 at 8 09 16 PM" src="https://user-images.githubusercontent.com/2234901/132429564-2bc34837-33dc-41cc-a8f3-107c29e9a40a.png" /></p>
<p>The source for this view is populated from the video file configured in <code>dev-config.yaml</code> in the Ambianic Edge CDE. 
You can change the file with your own recorded video file for testing various detection scenarios.</p>
<p><img alt="Screen Shot 2021-09-07 at 8 09 46 PM" src="https://user-images.githubusercontent.com/2234901/132429600-4f17fb59-4252-4962-b2cd-5fbc1071b55f.png" /></p>
<p>Notice how the <code>peerfetch</code> terminal shows a log of HTTP fetch requests and responses from the Ambianic UI instance. This is an indication that the UI and Edge are communicating. If you switch to the Fastapi terminal it will also show REST API requests served to the <code>peerfetch</code> proxy on behalf of the UI app (PWA).</p>
<p>Now you have a fully setup live and realistic system that runs both Ambianic UI and Ambianic Edge in dev mode. 
This setup represents as closely as possible the real world experience of an end user, while allowing you, dear developer, to test, experiment and commit code.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Ambianic.ai &copy; 2019-2021</p>
            <p>Last update : 2021-09-09 18:34:33.328660+00:00</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
